<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ポストのシェアボタン</title>
</head>
<body>
    <h1>現在のページをポストする</h1>
    
    <button id="share-button">ポストする</button>

    <script>
        // コード2: URLをBitlyを使用して短縮
        const bitlyAccessToken = '0befc28d8e2e810e26148835e0776880be38f9d1';
        const longURL = window.location.href;  // 現在のページのURLを使用

        fetch('https://api-ssl.bitly.com/v4/shorten', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${bitlyAccessToken}`,
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                long_url: longURL,
            }),
        })
            .then(response => response.json())
            .then(data => {
                const shortURL = data.link;

                // コード1: TwitterでURLをシェア
                const shareButton = document.getElementById("share-button");
                shareButton.addEventListener("click", () => {
                    // 現在のページのURLとタイトルを取得
                    const pageTitle = document.title;

                    // Bitlyで短縮したURLをTwitterでシェア
                    const twitterIntentUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(shortURL)}&text=${encodeURIComponent(pageTitle)}`;
                    
                    // ツイート用のポップアップウィンドウを開く
                    window.open(twitterIntentUrl, "_blank", "width=600,height=400");

                    // ポップアップブロックを回避するためにユーザーアクション後にウィンドウを開く必要があります
                });

            })
            .catch(error => {
                console.error('Error: ' + error);
            });

        


        
        
    </script>


</body>
</html>

